import type { AppLocale } from "./locale";

export const APP_TITLE_ZH = "Resin · 高性能粘性代理池";
const APP_TITLE_EN = "Resin · Sticky Proxy Pool";

const HAN_RE = /[\u3400-\u9fff]/;

const EXACT_ZH_TO_EN: Record<string, string> = {
  "Resin · 高性能粘性代理池": APP_TITLE_EN,
  "高性能粘性代理池 · 管理面板": "High-performance sticky proxy pool · Admin Console",
  "主导航": "Main Navigation",
  "切换语言": "Switch Language",
  "安全警告": "Security Warning",
  "退出登录": "Sign Out",
  "当前为免认证访问模式": "Running in no-auth mode",
  "管理员登录": "Admin Login",
  "输入后端 `RESIN_ADMIN_TOKEN` 进入控制台。": "Enter backend `RESIN_ADMIN_TOKEN` to access the console.",
  "粘贴 Bearer Token（仅本地保存）": "Paste Bearer Token (stored locally only)",
  "进入控制台": "Enter Console",
  "校验中...": "Verifying...",
  "请输入 Admin Token": "Please enter Admin Token",
  "总览看板": "Dashboard",
  "平台管理": "Platform Management",
  "集中维护平台策略与节点分配规则。": "Centrally manage platform policies and node allocation rules.",
  "订阅管理": "Subscription Management",
  "节点池": "Node Pool",
  "请求头规则": "Header Rules",
  "请求日志": "Request Logs",
  "资源": "Resources",
  "系统配置": "System Config",
  "刷新": "Refresh",
  "刷新中...": "Refreshing...",
  "保存配置": "Save Config",
  "保存规则": "Save Rule",
  "保存中...": "Saving...",
  "操作": "Actions",
  "删除": "Delete",
  "删除中...": "Deleting...",
  "创建中...": "Creating...",
  "更新中...": "Updating...",
  "测试中...": "Testing...",
  "探测中...": "Probing...",
  "加载报文内容中...": "Loading payload...",
  "查询": "Lookup",
  "重置": "Reset",
  "重置中...": "Resetting...",
  "重建路由池": "Rebuild Routing Pool",
  "重建中...": "Rebuilding...",
  "重置为默认配置": "Reset to Defaults",
  "确认创建": "Create",
  "取消": "Cancel",
  "关闭": "Close",
  "上一页": "Previous",
  "下一页": "Next",
  "每页": "Per page",
  "跳至": "Go to",
  "页": "Page",
  "选择页码": "Select page",
  "无更多数据": "No more data",
  "存在下一页": "More pages available",
  "成功": "Success",
  "失败": "Failed",
  "未知错误": "Unknown error",
  "错误": "Error",
  "状态": "Status",
  "健康": "Healthy",
  "熔断": "Circuit Open",
  "待测": "Pending Test",
  "运行中": "Running",
  "已停用": "Disabled",
  "启用": "Enabled",
  "仅启用": "Enabled only",
  "仅禁用": "Disabled only",
  "新建": "Create",
  "编辑": "Edit",
  "删除平台": "Delete Platform",
  "删除订阅": "Delete Subscription",
  "删除规则": "Delete Rule",
  "请求": "Request",
  "响应": "Response",
  "平台": "Platform",
  "账号": "Account",
  "代理": "Proxy",
  "代理类型": "Proxy Type",
  "网络": "Network",
  "网络状态": "Network Status",
  "HTTP 状态": "HTTP Status",
  "目标": "Target",
  "目标主机": "Target Host",
  "目标地址": "Target Address",
  "客户端 IP": "Client IP",
  "出口 IP": "Egress IP",
  "区域": "Region",
  "流量": "Traffic",
  "耗时": "Latency",
  "时间": "Time",
  "开始时间": "Start Time",
  "结束时间": "End Time",
  "名称": "Name",
  "节点名": "Node Name",
  "节点": "Node",
  "节点数": "Node Count",
  "节点列表": "Node List",
  "连续失败": "Consecutive Failures",
  "参考延迟": "Reference Latency",
  "上次探测": "Last Probe",
  "上次检查": "Last Check",
  "上次更新": "Last Updated",
  "创建时间": "Created At",
  "详情": "Details",
  "运维": "Ops",
  "监控": "Monitoring",
  "配置": "Configuration",
  "规则编辑": "Rule Editor",
  "规则测试": "Rule Test",
  "规则列表": "Rule List",
  "请求头": "Headers",
  "地址前缀": "URL Prefix",
  "URL 前缀": "URL Prefix",
  "请求头不能为空": "Headers cannot be empty",
  "地址前缀不能为空": "URL prefix cannot be empty",
  "请输入 URL": "Please enter a URL",
  "请输入 IP 地址": "Please enter an IP address",
  "输入 IP 地址例如 8.8.8.8": "Enter an IP address, e.g. 8.8.8.8",
  "输入 IP 执行查询": "Enter an IP address to query",
  "GeoIP 数据库更新任务已执行": "GeoIP database update task has been triggered",
  "数据库状态": "Database Status",
  "数据库更新时间": "Database Updated At",
  "数据库已加载": "Database loaded",
  "数据库未加载": "Database not loaded",
  "下次计划更新": "Next Scheduled Update",
  "单 IP 查询": "Single IP Lookup",
  "立即更新": "Update Now",
  "更新间隔": "Update Interval",
  "更新间隔不能为空": "Update interval cannot be empty",
  "订阅名称": "Subscription Name",
  "订阅链接": "Subscription URL",
  "订阅来源": "Subscription source",
  "订阅来源类型": "Subscription source type",
  "订阅类型": "Subscription type",
  "订阅内容": "Subscription content",
  "订阅内容不能为空": "Subscription content cannot be empty",
  "订阅源": "Subscription Source",
  "本地文本": "Local text",
  "本地订阅文本": "Local subscription text",
  "远程": "Remote",
  "本地": "Local",
  "从 HTTP/HTTPS 订阅链接拉取内容": "Fetch content from HTTP/HTTPS subscription URL",
  "直接填写订阅文本，不经过网络拉取": "Provide subscription text directly without network fetch",
  "支持 sing-box JSON / Clash YAML / URI 列表": "Supports sing-box JSON / Clash YAML / URI list",
  "临时订阅": "Temporary Subscription",
  "临时节点驱逐延迟": "Temporary Node Eviction Delay",
  "平台列表": "Platform List",
  "平台详情": "Platform Details",
  "返回列表": "Back to List",
  "平台配置": "Platform Configuration",
  "运维操作": "Ops Actions",
  "平台监控": "Platform Monitoring",
  "平台节点快照": "Platform Node Snapshot",
  "可路由节点": "Routable Nodes",
  "可路由节点数": "Routable Node Count",
  "请求成功率": "Request Success Rate",
  "活跃租约": "Active Leases",
  "活跃租约数": "Active Lease Count",
  "活跃租约趋势": "Active Lease Trend",
  "请求统计": "Request Stats",
  "请求总数": "Total Requests",
  "成功请求数": "Successful Requests",
  "节点总数": "Total Nodes",
  "健康节点数": "Healthy Nodes",
  "节点健康率": "Node Health Ratio",
  "吞吐趋势": "Throughput Trend",
  "连接峰值": "Connection Peaks",
  "入站连接": "Inbound Connections",
  "出站连接": "Outbound Connections",
  "下载速率": "Download Rate",
  "上传速率": "Upload Rate",
  "下载流量": "Download Traffic",
  "上传流量": "Upload Traffic",
  "流量累计": "Traffic Total",
  "探测任务量": "Probe Volume",
  "探测次数": "Probe Count",
  "延迟直方图": "Latency Histogram",
  "无可视化数据": "No chart data",
  "无分布数据": "No distribution data",
  "没有匹配的平台": "No matching platforms",
  "没有匹配的订阅": "No matching subscriptions",
  "没有匹配的节点": "No matching nodes",
  "没有匹配规则": "No matching rules",
  "没有匹配日志": "No matching logs",
  "正在加载平台数据...": "Loading platform data...",
  "正在加载平台详情...": "Loading platform details...",
  "正在加载节点数据...": "Loading node data...",
  "正在加载日志...": "Loading logs...",
  "正在加载规则...": "Loading rules...",
  "正在加载配置...": "Loading config...",
  "正在加载订阅数据...": "Loading subscription data...",
  "总览看板数据加载中...": "Dashboard is loading...",
  "平台监控数据加载中...": "Platform monitoring data is loading...",
  "监控数据刷新中": "Refreshing monitoring data",
  "重置草稿": "Reset Draft",
  "恢复为默认值": "Reset to Default",
  "恢复默认设置，并覆盖当前修改。": "Restore default settings and overwrite current changes.",
  "当前无未保存改动": "No unsaved changes",
  "当前有未保存变更，确认丢弃并重新加载运行时配置？":
    "There are unsaved changes. Discard and reload runtime config?",
  "没有可提交的变更": "No changes to submit",
  "已加载最新运行时配置": "Loaded latest runtime config",
  "已加载最新静态配置": "Loaded latest static config",
  "默认配置尚未加载": "Default config is not loaded",
  "配置尚未加载完成": "Config has not been fully loaded",
  "运行时配置": "Runtime Config",
  "静态配置": "Static Config",
  "变更摘要": "Change Summary",
  "修改后会在这里显示变更项": "Changed items will be shown here",
  "服务鉴权状态": "Service Auth Status",
  "已配置管理端令牌": "Admin token configured",
  "已配置代理令牌": "Proxy token configured",
  "请求日志落库": "Request logs persisted",
  "记录详细反代日志": "Record detailed reverse-proxy logs",
  "启用请求日志": "Enable request logs",
  "默认": "Default",
  "空": "Empty",
  "无": "None",
  "（空）": "(empty)",
  "（空 Headers）": "(empty headers)",
  "（空 Body）": "(empty body)",
  "[Base64 解码失败]": "[Base64 decode failed]",
  "已截断": "Truncated",
  "正向": "Forward",
  "反向": "Reverse",
  "正向代理": "Forward Proxy",
  "反向代理": "Reverse Proxy",
  "随机选择节点": "Select node randomly",
  "拒绝代理请求": "Reject proxy requests",
  "均衡": "Balanced",
  "优先低延迟": "Prefer low latency",
  "优先空闲出口 IP": "Prefer idle egress IP",
  "租约保持时长": "Lease Sticky TTL",
  "租约保持时长（可选）": "Lease Sticky TTL (optional)",
  "节点名正则过滤规则": "Node name regex filters",
  "节点名正则过滤规则（可选）": "Node name regex filters (optional)",
  "地区过滤规则": "Region filters",
  "地区过滤规则（可选）": "Region filters (optional)",
  "每行一条": "One per line",
  "每行一条，如 hk / us": "One per line, e.g. hk / us",
  "每行一个 header，例如 Authorization": "One header per line, e.g. Authorization",
  "输入地址查看命中规则和请求头。": "Enter URL to view matched rule and headers.",
  "命中前缀：": "Matched prefix:",
  "命中请求头：": "Matched headers:",
  "手动刷新": "Manual Refresh",
  "立即刷新": "Refresh Now",
  "立即清理": "Clean Now",
  "清理中...": "Cleaning...",
  "清理失效节点": "Clean invalid nodes",
  "当前请求未产生异常诊断信息": "No diagnostic errors were generated for this request",
  "日志摘要": "Log Summary",
  "报文内容": "Payload",
  "诊断": "Diagnostics",
  "目标与节点": "Target and Node",
  "Resin 错误:": "Resin Error:",
  "失败阶段:": "Failure Stage:",
  "错误类型:": "Error Type:",
  "错误详情:": "Error Details:",
  "该条日志未记录报文内容。": "This log has no payload captured.",
  "时间范围": "Time Range",
  "时间范围错误：开始时间必须早于结束时间，已暂不应用结束时间筛选。":
    "Invalid time range: start time must be earlier than end time; end-time filter is temporarily ignored.",
  "HTTP 状态码需为 100-599 的整数，当前输入暂不应用。":
    "HTTP status must be an integer between 100-599; current input is ignored.",
  "最近 1 小时": "Last 1 hour",
  "最近 6 小时": "Last 6 hours",
  "最近 24 小时": "Last 24 hours",
  "刚刚": "Just now",
  "0 秒": "0s",
  "RESIN_ADMIN_TOKEN 为空，控制面 API 免认证": "RESIN_ADMIN_TOKEN is empty, control-plane API is unauthenticated",
  "RESIN_PROXY_TOKEN 为空，正/反向代理免认证": "RESIN_PROXY_TOKEN is empty, forward/reverse proxy is unauthenticated",
  "RESIN_ADMIN_TOKEN 强度较弱，建议更换为更高熵随机令牌":
    "RESIN_ADMIN_TOKEN is weak, use a higher-entropy random token",
  "RESIN_PROXY_TOKEN 强度较弱，建议更换为更高熵随机令牌":
    "RESIN_PROXY_TOKEN is weak, use a higher-entropy random token",
  "按分类查看和修改设置，可随时撤销未保存更改。":
    "View and edit settings by category. Unsaved changes can be reverted at any time.",
  "按条件检索请求记录，快速定位问题。":
    "Filter request logs by conditions to quickly locate issues.",
  "按需调整系统参数，保存后立即生效。":
    "Tune system parameters as needed; changes take effect immediately after saving.",
  "保障订阅按计划更新，异常时可一键刷新。":
    "Keep subscriptions updated on schedule; refresh with one click when abnormal.",
  "被此平台路由": "Routed by this platform",
  "编辑当前规则": "Edit current rule",
  "拨测超时时间": "Probe timeout",
  "策略": "Policy",
  "查看当前平台的租约、请求成功率、延迟和节点情况。":
    "View current platform leases, request success rate, latency, and node status.",
  "查看请求/响应内容。": "View request/response payloads.",
  "查询 IP 所在地区，并维护 GeoIP 数据库。":
    "Lookup IP regions and maintain the GeoIP database.",
  "持久化策略": "Persistence policy",
  "出口 / 区域": "Egress / Region",
  "出口 IP 更新检查间隔": "Egress IP refresh check interval",
  "出口 IP 数": "Egress IP count",
  "出口探测": "Egress probe",
  "窗口内下载 / 上传流量（字节）": "Download / upload traffic in window (bytes)",
  "代理传输最大空闲连接": "Max idle proxy transport connections",
  "单主机最大空闲连接": "Max idle connections per host",
  "当前加载时间与下一次计划更新时间":
    "Current load time and next scheduled update time",
  "当前平台节点池与延迟样本": "Current platform node pool and latency samples",
  "当前实时值": "Current realtime value",
  "调试": "Debug",
  "调整当前平台策略，并执行维护操作。":
    "Adjust current platform policies and perform maintenance operations.",
  "订阅列表": "Subscription list",
  "订阅配置": "Subscription configuration",
  "队列大小": "Queue size",
  "反向代理未命中策略": "Reverse proxy miss policy",
  "访问延迟分布（历史最新桶）":
    "Access latency distribution (latest historical bucket)",
  "更新 URL、刷新周期与状态开关后点击保存。":
    "Update URL, refresh interval, and enable switch, then save.",
  "更新本地订阅文本、刷新周期与状态开关后点击保存。":
    "Update local subscription text, refresh interval, and enable switch, then save.",
  "缓存刷盘脏阈值": "Cache flush dirty threshold",
  "缓存异步刷盘间隔": "Async cache flush interval",
  "基础与健康检查": "Basics and health checks",
  "检测节点网络延迟。": "Probe node network latency.",
  "检查节点当前出口 IP。": "Check current node egress IP.",
  "节点别名": "Node alias",
  "节点拨测并发数": "Node probe concurrency",
  "节点池趋势": "Node pool trend",
  "节点的网络出口、探测状态以及失败历史。":
    "Node network egress, probe status, and failure history.",
  "节点分配策略": "Node allocation policy",
  "节点延迟分布": "Node latency distribution",
  "节点延迟分布（实时快照）": "Node latency distribution (realtime snapshot)",
  "节点延迟最大测试间隔": "Max node latency probe interval",
  "节点状态": "Node status",
  "节点总数 / 健康节点数": "Total nodes / healthy nodes",
  "可查看数据库状态并进行 IP 查询。": "View database status and run IP lookups.",
  "可观测性指标": "Observability metrics",
  "空闲连接超时时间": "Idle connection timeout",
  "控制面最大请求体": "Control-plane max request body",
  "快速定位异常节点并进行探测处理。":
    "Quickly locate abnormal nodes and probe them.",
  "快速发现流量与节点异常，掌握整体运行状态。":
    "Quickly detect traffic and node anomalies, and grasp overall runtime status.",
  "快照更新时间": "Snapshot updated at",
  "来自此订阅": "From this subscription",
  "来自环境变量和启动参数的只读配置。":
    "Read-only config from environment variables and startup flags.",
  "来自所有平台租约总和": "Sum of leases across all platforms",
  "历史访问延迟分布": "Historical access latency distribution",
  "历史探测总次数": "Total historical probe count",
  "历史延迟衰减窗口": "Historical latency decay window",
  "历史租约时长统计": "Historical lease duration stats",
  "立即清理当前熔断，或出错错误的节点。（订阅更新后节点可能会被重新添加）":
    "Immediately clean circuit-open or errored nodes. (They may be re-added after subscription refresh.)",
  "立即刷新订阅并同步节点。": "Refresh subscription immediately and sync nodes.",
  "连接数保留时间": "Connection retention window",
  "连接数抽样间隔": "Connection sampling interval",
  "落盘间隔": "Flush interval",
  "落盘批大小": "Flush batch size",
  "默认地区黑名单": "Default region blacklist",
  "默认反代不匹配行为": "Default reverse-proxy miss action",
  "默认节点分配策略": "Default node allocation policy",
  "默认平台回退规则": "Default platform fallback rule",
  "默认粘性会话 TTL": "Default sticky session TTL",
  "默认正则黑名单": "Default regex blacklist",
  "目录与端口": "Paths and ports",
  "平台 ID 缺失，无法加载详情。": "Platform ID is missing; unable to load details.",
  "平台实时租约数量": "Platform realtime lease count",
  "请求目标与命中节点信息。": "Request target and matched node info.",
  "请求时间、协议结果与平台路由信息。":
    "Request time, protocol result, and platform routing info.",
  "请求体最大字节数": "Max request body bytes",
  "请求头最大字节数": "Max request header bytes",
  "请求质量": "Request quality",
  "请求总量 + 成功率": "Total requests + success rate",
  "全部": "All",
  "全局限额与性能调优": "Global limits and performance tuning",
  "权威域名最大测试间隔": "Max authority probe interval",
  "日志保留目录": "Log retention directory",
  "熔断 / 待测": "Circuit open / pending test",
  "删除订阅并清理关联节点，操作不可撤销。":
    "Delete subscription and clean related nodes; this action cannot be undone.",
  "实时节点延迟分布快照": "Realtime node latency distribution snapshot",
  "实时连接数": "Realtime connections",
  "实时入站 / 出站连接": "Realtime inbound / outbound connections",
  "实时吞吐": "Realtime throughput",
  "实时下载 / 上传速率（bps）": "Realtime download / upload rate (bps)",
  "输入 IP 后点击查询。": "Enter an IP and click query.",
  "数据缓存目录": "Data cache directory",
  "数据库保留阈值": "Database retention threshold",
  "数据库旧分片保留数": "Old DB shard retention count",
  "探测与路由": "Probing and routing",
  "统一服务端口": "Unified service port",
  "统一监听地址": "Unified listen address",
  "吞吐量保留时间": "Throughput retention window",
  "吞吐量抽样间隔": "Throughput sampling interval",
  "为不同地址设置请求头规则，并先测试后应用。":
    "Configure header rules per address and test before applying.",
  "未命中策略": "Miss policy",
  "无节点名信息": "No node name info",
  "无限制": "No limit",
  "响应体最大字节数": "Max response body bytes",
  "响应头最大字节数": "Max response header bytes",
  "新建订阅": "New subscription",
  "新建规则": "New rule",
  "新建平台": "New platform",
  "修改地址前缀和请求头后保存。":
    "Modify URL prefix and headers, then save.",
  "修改过滤策略与路由策略后点击保存。":
    "Modify filtering and routing policies, then save.",
  "延迟测试目标 URL": "Latency test target URL",
  "延迟测试权威域名列表": "Latency test authority domain list",
  "延迟探测": "Latency probe",
  "延迟统计截断值": "Latency histogram cap",
  "延迟统计桶宽": "Latency histogram bin width",
  "延迟样本数": "Latency sample count",
  "已禁用": "Disabled",
  "以下操作会直接作用于当前平台，请谨慎执行。":
    "The following actions apply directly to this platform. Proceed carefully.",
  "异常排查与连接状态分析。": "Troubleshooting and connection state analysis.",
  "永久删除当前平台及其配置，操作不可撤销。":
    "Permanently delete this platform and its config. This action cannot be undone.",
  "正常": "Normal",
  "正则": "Regex",
  "中文": "中文",
  "重新整理当前平台可用节点，不会修改配置。":
    "Rebuild available nodes for this platform without changing configuration.",
  "状态存储目录": "State storage directory",
  "资源获取超时时间": "Resource fetch timeout",
  "总请求数 / 成功请求数": "Total requests / successful requests",
  "租期保留时间": "Lease retention window",
  "租期抽样间隔": "Lease sampling interval",
  "租期与连接指标分桶数": "Lease and connection metric bucket count",
  "租约 P50 存活时长": "Lease P50 lifetime",
  "租约存活分位趋势": "Lease lifetime quantile trend",
  "租约时长": "Lease duration",
  "最大连续失败次数": "Max consecutive failures",
  "最大延迟表条目数": "Max latency table entries",
  "最近一次刷新无错误": "Last refresh had no errors",
  "GeoIP 更新计划": "GeoIP update schedule",
  "P2C 延迟衰减窗口": "P2C latency decay window",
  "(已手动修改)": "(manually edited)",
  "触发出口探测": "Trigger egress probe",
  "触发延迟探测": "Trigger latency probe",
  "当前浏览器不支持 DecompressionStream，无法自动解压":
    "Current browser does not support DecompressionStream; automatic decompression is unavailable.",
  "当前实时日志记录已开启": "Realtime request logging is enabled",
  "当前实时日志记录未开启": "Realtime request logging is disabled",
  "登录失败：无法连接 API。请确认 Resin 在 2260 端口运行，并使用 `npm run dev`（含 /api 代理）启动前端。":
    "Login failed: unable to connect to API. Ensure Resin runs on port 2260 and frontend is started with `npm run dev` (with /api proxy).",
  '兜底规则 "*" 不可删除': 'Fallback rule "*" cannot be deleted',
  '兜底规则 "*" 不允许删除': 'Fallback rule "*" cannot be deleted',
  '兜底规则 "*" 仅允许编辑，不允许删除。':
    'Fallback rule "*" can be edited only and cannot be deleted.',
  "关闭编辑面板": "Close edit panel",
  "关闭详情面板": "Close detail panel",
  "规则编辑抽屉": "Rule edit drawer",
  "过滤规则与分配策略": "Filtering rules and allocation policy",
  "禁用订阅后，节点不会进入各平台的路由池，但不会从全局节点池中删除。":
    "After disabling a subscription, nodes won't enter platform routing pools, but they will remain in the global node pool.",
  "开始测试": "Start test",
  "例如 12h": "e.g. 12h",
  "例如 168h": "e.g. 168h",
  "例如 72h": "e.g. 72h",
  "例如 api.example.com/v1": "e.g. api.example.com/v1",
  "临时节点驱逐延迟不能为空": "Temporary node eviction delay cannot be empty",
  "模糊搜索": "Fuzzy search",
  "内置平台": "Built-in platform",
  "自定义平台": "Custom platform",
  "平台 / 账号": "Platform / Account",
  "平台不存在或已被删除": "Platform does not exist or has been deleted",
  "平台名称不能为空": "Platform name cannot be empty",
  "平台详情板块": "Platform detail sections",
  "平台运行态趋势和快照": "Platform runtime trends and snapshots",
  "请求日志详情": "Request log details",
  "请选择要编辑的订阅": "Please select a subscription to edit",
  "删除后该规则将不再生效。": "After deletion, this rule will no longer take effect.",
  "手动编辑的 JSON 格式有误，请检查": "Invalid manually edited JSON format. Please check.",
  "搜索订阅": "Search subscriptions",
  "搜索规则": "Search rules",
  "搜索平台": "Search platforms",
  "延迟测试目标 URL 必须是 http/https 地址":
    "Latency test target URL must be an http/https URL",
  "延迟测试目标 URL 不能为空": "Latency test target URL cannot be empty",
  "预览节点池": "Preview node pool",
  "暂无访问延迟分布数据": "No access latency distribution data",
  "暂无节点延迟快照数据": "No node latency snapshot data",
  "暂无请求统计数据": "No request statistics data",
  "暂无租约生命周期数据": "No lease lifecycle data",
  "暂无租约实时数据": "No realtime lease data",
  "重建、重置、删除操作": "Rebuild, reset, and delete operations",
  "总请求数": "Total request count",
  "URL 必须是 http/https 地址": "URL must be an http/https URL",
  "URL 不能为空": "URL cannot be empty",
  "User-Agent 不能为空": "User-Agent cannot be empty",
  "最近错误": "Recent errors",
};

type PatternRule = {
  pattern: RegExp;
  replace: (...groups: string[]) => string;
};

const PATTERN_RULES: PatternRule[] = [
  {
    pattern: /^第 (\d+) \/ (\d+) 页 · 显示 (\d+)-(\d+) \/ (\d+)$/,
    replace: (page, pages, start, end, total) => `Page ${page} / ${pages} · Showing ${start}-${end} / ${total}`,
  },
  {
    pattern: /^第 (\d+) 页 · 存在下一页$/,
    replace: (page) => `Page ${page} · More pages available`,
  },
  {
    pattern: /^第 (\d+) 页 · 无更多数据$/,
    replace: (page) => `Page ${page} · No more data`,
  },
  {
    pattern: /^平台 (.+) 创建成功$/,
    replace: (name) => `Platform ${name} created successfully`,
  },
  {
    pattern: /^平台 (.+) 已更新$/,
    replace: (name) => `Platform ${name} updated`,
  },
  {
    pattern: /^平台 (.+) 已删除$/,
    replace: (name) => `Platform ${name} deleted`,
  },
  {
    pattern: /^平台 (.+) 已重置为默认配置$/,
    replace: (name) => `Platform ${name} reset to defaults`,
  },
  {
    pattern: /^平台 (.+) 已完成节点池重建$/,
    replace: (name) => `Platform ${name} node pool rebuilt`,
  },
  {
    pattern: /^订阅 (.+) 创建成功$/,
    replace: (name) => `Subscription ${name} created successfully`,
  },
  {
    pattern: /^订阅 (.+) 已更新$/,
    replace: (name) => `Subscription ${name} updated`,
  },
  {
    pattern: /^订阅 (.+) 已删除$/,
    replace: (name) => `Subscription ${name} deleted`,
  },
  {
    pattern: /^订阅 (.+) 已手动刷新$/,
    replace: (name) => `Subscription ${name} refreshed`,
  },
  {
    pattern: /^订阅 (.+) 已清理 (\d+) 个节点$/,
    replace: (name, count) => `Subscription ${name} cleaned ${count} nodes`,
  },
  {
    pattern: /^订阅 (.+) 没有可清理的熔断或异常节点$/,
    replace: (name) => `Subscription ${name} has no circuit-open or error nodes to clean`,
  },
  {
    pattern: /^规则 (.+) 已创建$/,
    replace: (prefix) => `Rule ${prefix} created`,
  },
  {
    pattern: /^规则 (.+) 已保存$/,
    replace: (prefix) => `Rule ${prefix} saved`,
  },
  {
    pattern: /^规则 (.+) 已删除$/,
    replace: (prefix) => `Rule ${prefix} deleted`,
  },
  {
    pattern: /^确认删除平台 (.+)？该操作不可撤销。$/,
    replace: (name) => `Delete platform ${name}? This action cannot be undone.`,
  },
  {
    pattern: /^确认删除订阅 (.+)？关联节点会被清理。$/,
    replace: (name) => `Delete subscription ${name}? Related nodes will be cleaned.`,
  },
  {
    pattern: /^确认删除规则 (.+) 吗？$/,
    replace: (prefix) => `Delete rule ${prefix}?`,
  },
  {
    pattern: /^确认立即清理订阅 (.+) 中的熔断或异常节点？$/,
    replace: (name) => `Clean circuit-open or error nodes in subscription ${name} now?`,
  },
  {
    pattern: /^登录失败：(.+)$/,
    replace: (message) => `Login failed: ${message}`,
  },
  {
    pattern: /^配置已更新（(\d+) 项变更）$/,
    replace: (count) => `Config updated (${count} changes)`,
  },
  {
    pattern: /^恢复为默认值: (.+)$/,
    replace: (value) => `Reset to default: ${value}`,
  },
  {
    pattern: /^编辑订阅 (.+)$/,
    replace: (name) => `Edit subscription ${name}`,
  },
  {
    pattern: /^预览订阅 (.+) 的节点池$/,
    replace: (name) => `Preview node pool of subscription ${name}`,
  },
  {
    pattern: /^节点详情 (.+)$/,
    replace: (name) => `Node details ${name}`,
  },
  {
    pattern: /^请求日志详情 (.+)$/,
    replace: (id) => `Request log details ${id}`,
  },
  {
    pattern: /^节点数 (.+)$/,
    replace: (count) => `Nodes ${count}`,
  },
  {
    pattern: /^出口探测完成：出口 IP=(.+)，区域=(.+)，延迟=(.+)$/,
    replace: (ip, region, latency) => `Egress probe complete: egress IP=${ip}, region=${region}, latency=${latency}`,
  },
  {
    pattern: /^延迟探测完成：延迟=(.+)$/,
    replace: (latency) => `Latency probe complete: latency=${latency}`,
  },
  {
    pattern: /^更新于 (.+)$/,
    replace: (time) => `Updated ${time}`,
  },
  {
    pattern: /^下载 (.+)$/,
    replace: (value) => `Download ${value}`,
  },
  {
    pattern: /^上传 (.+)$/,
    replace: (value) => `Upload ${value}`,
  },
  {
    pattern: /^入站 (.+)$/,
    replace: (value) => `Inbound ${value}`,
  },
  {
    pattern: /^出站 (.+)$/,
    replace: (value) => `Outbound ${value}`,
  },
  {
    pattern: /^共 (\d+) 个平台$/,
    replace: (count) => `${count} platforms`,
  },
  {
    pattern: /^共 (\d+) 个节点，(\d+) 个健康 IP$/,
    replace: (nodes, healthyIPs) => `${nodes} nodes, ${healthyIPs} healthy IPs`,
  },
  {
    pattern: /^共 (\d+) 条$/,
    replace: (count) => `${count} items`,
  },
  {
    pattern: /^(\d+) 个可用节点$/,
    replace: (count) => `${count} available nodes`,
  },
  {
    pattern: /^样本 (.+)$/,
    replace: (count) => `Samples ${count}`,
  },
  {
    pattern: /^\[Body 解码失败：(.+)\]$/,
    replace: (message) => `[Body decode failed: ${message}]`,
  },
  {
    pattern: /^暂不支持的 Content-Encoding: (.+)$/,
    replace: (encoding) => `Unsupported Content-Encoding: ${encoding}`,
  },
  {
    pattern: /^Content-Encoding=(.+) 解压失败$/,
    replace: (encoding) => `Failed to decode Content-Encoding=${encoding}`,
  },
  {
    pattern: /^在节点池搜索 (.+)$/,
    replace: (nodeTag) => `Search in node pool: ${nodeTag}`,
  },
  {
    pattern: /^(.+)不能为空$/,
    replace: (field) => `${field} cannot be empty`,
  },
  {
    pattern: /^(.+)必须是 http\/https 地址$/,
    replace: (field) => `${field} must be an http/https URL`,
  },
  {
    pattern: /^(.+)必须是非负整数$/,
    replace: (field) => `${field} must be a non-negative integer`,
  },
  {
    pattern: /^(.+)不存在或已被删除$/,
    replace: (entity) => `${entity} does not exist or has been deleted`,
  },
  {
    pattern: /^(.+)创建成功$/,
    replace: (entity) => `${entity} created successfully`,
  },
  {
    pattern: /^(.+)已更新$/,
    replace: (entity) => `${entity} updated`,
  },
  {
    pattern: /^(.+)已删除$/,
    replace: (entity) => `${entity} deleted`,
  },
  {
    pattern: /^(.+)已保存$/,
    replace: (entity) => `${entity} saved`,
  },
  {
    pattern: /^(.+)已加载$/,
    replace: (entity) => `${entity} loaded`,
  },
];

const TERM_REPLACEMENTS: Array<[string, string]> = [
  ["共 ", ""],
  [" 个平台", " platforms"],
  [" 个订阅", " subscriptions"],
  [" 个节点，", " nodes, "],
  [" 个健康 IP", " healthy IPs"],
  [" 个可用节点", " available nodes"],
  [" 条", " items"],
  ["更新于 ", "Updated "],
  ["下载 ", "Download "],
  ["上传 ", "Upload "],
  ["入站 ", "Inbound "],
  ["出站 ", "Outbound "],
  ["样本 ", "Samples "],
  ["最近错误：", "Recent error: "],
  ["总览看板", "Dashboard"],
  ["平台管理", "Platform Management"],
  ["平台监控", "Platform Monitoring"],
  ["平台详情", "Platform Details"],
  ["订阅管理", "Subscription Management"],
  ["节点池", "Node Pool"],
  ["请求头规则", "Header Rules"],
  ["请求日志", "Request Logs"],
  ["系统配置", "System Config"],
  ["资源", "Resources"],
  ["反向代理", "Reverse Proxy"],
  ["正向代理", "Forward Proxy"],
  ["反向", "Reverse"],
  ["正向", "Forward"],
  ["节点分配策略", "Node Allocation Policy"],
  ["未命中策略", "Miss Policy"],
  ["租约保持时长", "Lease Sticky TTL"],
  ["启用请求日志", "Enable Request Logs"],
  ["记录详细反代日志", "Record Detailed Reverse Proxy Logs"],
  ["最大连续失败次数", "Max Consecutive Failures"],
  ["延迟测试目标 URL", "Latency Test Target URL"],
  ["延迟测试权威域名列表", "Latency Test Authorities"],
  ["节点延迟最大测试间隔", "Max Node Latency Probe Interval"],
  ["权威域名最大测试间隔", "Max Authority Probe Interval"],
  ["出口 IP 更新检查间隔", "Egress IP Refresh Check Interval"],
  ["缓存异步刷盘间隔", "Cache Flush Interval"],
  ["缓存刷盘脏阈值", "Cache Flush Dirty Threshold"],
  ["请求头最大字节数", "Max Request Header Bytes"],
  ["请求体最大字节数", "Max Request Body Bytes"],
  ["响应头最大字节数", "Max Response Header Bytes"],
  ["响应体最大字节数", "Max Response Body Bytes"],
  ["请求成功率", "Request Success Rate"],
  ["成功请求数", "Successful Requests"],
  ["总请求数", "Total Requests"],
  ["健康节点数", "Healthy Nodes"],
  ["节点总数", "Total Nodes"],
  ["活跃租约", "Active Leases"],
  ["吞吐趋势", "Throughput Trend"],
  ["连接峰值", "Connection Peaks"],
  ["节点延迟分布", "Node Latency Distribution"],
  ["流量累计", "Traffic Total"],
  ["探测任务量", "Probe Volume"],
  ["下载速率", "Download Rate"],
  ["上传速率", "Upload Rate"],
  ["下载流量", "Download Traffic"],
  ["上传流量", "Upload Traffic"],
  ["出站连接", "Outbound Connections"],
  ["入站连接", "Inbound Connections"],
  ["数据库状态", "Database Status"],
  ["数据库更新时间", "Database Updated At"],
  ["下次计划更新", "Next Scheduled Update"],
  ["单 IP 查询", "Single IP Lookup"],
  ["当前加载时间与下一次计划更新时间", "Current load time and next scheduled update time"],
  ["当前为免认证访问模式", "Running in no-auth mode"],
  ["安全警告", "Security Warning"],
  ["主导航", "Main Navigation"],
  ["请输入", "Please enter "],
  ["不能为空", " cannot be empty"],
  ["必须是非负整数", " must be a non-negative integer"],
  ["必须是 http/https 地址", " must be a http/https URL"],
  ["创建成功", "created successfully"],
  ["已更新", "updated"],
  ["已删除", "deleted"],
  ["已保存", "saved"],
  ["已加载", "loaded"],
  ["已清理", "cleaned"],
  ["已手动刷新", "refreshed"],
  ["不存在或已被删除", "does not exist or has been deleted"],
  ["立即刷新", "Refresh Now"],
  ["立即清理", "Clean Now"],
  ["立即更新", "Update Now"],
  ["刷新中", "Refreshing"],
  ["保存中", "Saving"],
  ["更新中", "Updating"],
  ["创建中", "Creating"],
  ["删除中", "Deleting"],
  ["重置中", "Resetting"],
  ["重建中", "Rebuilding"],
  ["探测中", "Probing"],
  ["测试中", "Testing"],
  ["校验中", "Verifying"],
  ["加载中", "Loading"],
  ["登录失败", "Login failed"],
  ["规则", "Rule"],
  ["订阅", "Subscription"],
  ["平台", "Platform"],
  ["节点", "Node"],
  ["日志", "Log"],
  ["请求", "Request"],
  ["响应", "Response"],
  ["地址", "Address"],
  ["目标", "Target"],
  ["状态", "Status"],
  ["成功", "Success"],
  ["失败", "Failed"],
  ["错误", "Error"],
  ["健康", "Healthy"],
  ["熔断", "Circuit Open"],
  ["待测", "Pending Test"],
  ["启用", "Enable"],
  ["禁用", "Disable"],
  ["刷新", "Refresh"],
  ["保存", "Save"],
  ["删除", "Delete"],
  ["创建", "Create"],
  ["更新", "Update"],
  ["查询", "Lookup"],
  ["重置", "Reset"],
  ["重建", "Rebuild"],
  ["关闭", "Close"],
  ["取消", "Cancel"],
  ["确认", "Confirm"],
  ["返回", "Back"],
];

function escapeRegExp(value: string): string {
  return value.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}

const TERM_RULES = TERM_REPLACEMENTS.map(([source, target]) => ({
  pattern: new RegExp(escapeRegExp(source), "g"),
  target,
}));

function applyPatternRules(text: string): string {
  let output = text;
  for (const rule of PATTERN_RULES) {
    const match = output.match(rule.pattern);
    if (!match) {
      continue;
    }
    output = output.replace(rule.pattern, rule.replace(...match.slice(1)));
  }
  return output;
}

function applyTermRules(text: string): string {
  let output = text;
  for (const rule of TERM_RULES) {
    output = output.replace(rule.pattern, rule.target);
  }
  return output;
}

export function translate(locale: AppLocale, text: string): string {
  if (locale === "zh-CN") {
    return text;
  }
  if (!text || !HAN_RE.test(text)) {
    return text;
  }

  const exact = EXACT_ZH_TO_EN[text];
  if (exact) {
    return exact;
  }

  let output = applyPatternRules(text);
  output = applyTermRules(output);
  output = output
    .replace(/，/g, ", ")
    .replace(/。/g, ".")
    .replace(/：/g, ": ")
    .replace(/；/g, "; ")
    .replace(/（/g, "(")
    .replace(/）/g, ")");

  // Keep leading/trailing whitespace from source text nodes.
  // React often splits sentence fragments into multiple adjacent text nodes.
  // Trimming here would glue translated fragments together (e.g. "4subscriptions").
  output = output.replace(/[^\S\r\n]{2,}/g, " ");

  // Avoid mixed-language artifacts from partial term replacement.
  // If translation is not fully resolved, keep original text.
  if (HAN_RE.test(output)) {
    return text;
  }

  return output;
}

export function translateDocumentTitle(locale: AppLocale): string {
  return locale === "en-US" ? APP_TITLE_EN : APP_TITLE_ZH;
}
